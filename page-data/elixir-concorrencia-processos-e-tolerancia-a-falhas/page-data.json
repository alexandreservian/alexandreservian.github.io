{"componentChunkName":"component---src-templates-post-index-js","path":"/elixir-concorrencia-processos-e-tolerancia-a-falhas","result":{"data":{"markdownRemark":{"html":"<p>Há alguns meses venho estudando <strong>Elixir</strong>, e com ele me deparei com vários conceitos ligados à linguagem. Entre esses conceitos, encontra-se uma das bases da linguagem: seu modelo de <strong>concorrência</strong>.</p>\n<p>Elixir é uma linguagem funcional que compila para bytecode que executa em uma máquina virtual chamada <strong>BEAM</strong>, máquina virtual <strong>Erlang</strong>, sendo Erlang uma linguagem criada há mais de 30 anos no setor de telecomunicações. Claro que Erlang/Elixir pode ser usado para quaisquer fins, mas sua herança neste setor formou a base de seu sistema de concorrência e tolerância a falhas.</p>\n<hr>\n<h3>Modelo de atores</h3>\n<p>No dia a dia como programador, nos deparamos com alguns modelos de concorrência, <strong>javascript</strong> com event-loop ou <strong>java</strong> com threads. Porém no Elixir usamos um modelo conhecido como <strong>modelo de atores</strong>.</p>\n<p>Um ator em Elixir é um <strong>processo Erlang</strong> (não confundir com processos do sistema operacional). Esses processos Erlang tem como características principais duas coisas: eles <strong>não compartilham</strong> a mesma memória, no caso são totalmente isolados dos outros processos, tendo seu estado <strong>privado</strong>, que nunca pode ser <strong>alterado</strong> por outro processo diretamente; eles se <strong>comunicam</strong> passando mensagens uns com os outros.</p>\n<p>Para que essa comunicação funcione, cada ator ou processo Erlang possui um “endereço” que nesse caso é um <strong>PID</strong>. Cada processo também possui uma mailbox que salva as mensagens recebidas em forma de <strong>queue</strong> (fila).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 810px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.86699507389164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQCA//EABYBAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABvq6YxwWJZmLVg//EABwQAQACAgMBAAAAAAAAAAAAAAECAwASEBExMv/aAAgBAQABBQKuxblddusfSZLiXzTAi5//xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAwEBPwFj/8QAFxEBAAMAAAAAAAAAAAAAAAAAAQAQUf/aAAgBAgEBPwEGA7f/xAAaEAACAgMAAAAAAAAAAAAAAAAAEQEQEiIx/9oACAEBAAY/AsUS4OMZrU3/AP/EAB0QAQACAgIDAAAAAAAAAAAAAAEAERAxIVFxgZH/2gAIAQEAAT8h0BLfWKluB54KH1OFd9wK1AIOqipFWsf/2gAMAwEAAgADAAAAENw//P/EABgRAQEBAQEAAAAAAAAAAAAAAAERABAx/9oACAEDAQE/EELQmpq+c//EABkRAQEBAAMAAAAAAAAAAAAAAAERABAxwf/aAAgBAgEBPxAQ1vmERyvXH//EAB8QAQEAAgIBBQAAAAAAAAAAAAERACExkYEQUWHh8P/aAAgBAQABPxBKjEhzF27/AFwGzAo3U784q8AvWrkBYHY+sblY7cQ9984AgA+MAGpCWUmIcEb1D0//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ilustração do modelo de atores\"\n        title=\"Ilustração do modelo de atores\"\n        src=\"/static/423c4c7344eb087b5cdf562776949db4/627f4/ilustracao-do-modelo-de-atores.jpg\"\n        srcset=\"/static/423c4c7344eb087b5cdf562776949db4/efcb5/ilustracao-do-modelo-de-atores.jpg 203w,\n/static/423c4c7344eb087b5cdf562776949db4/02e66/ilustracao-do-modelo-de-atores.jpg 405w,\n/static/423c4c7344eb087b5cdf562776949db4/627f4/ilustracao-do-modelo-de-atores.jpg 810w,\n/static/423c4c7344eb087b5cdf562776949db4/08d1d/ilustracao-do-modelo-de-atores.jpg 957w\"\n        sizes=\"(max-width: 810px) 100vw, 810px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Toda a troca de mensagens entre os atores/processos é feita de forma assíncrona usando a função <code class=\"language-text\">send/2</code> e para lidarmos com as mensagens recebidas ou que vamos receber usamos a macro <code class=\"language-text\">receive</code>.</p>\n<p>Como todo código Elixir roda em um processo, podemos demostrar as funções <strong>send</strong> e <strong>receive</strong> na prática usando o <strong>REPL</strong> do Elixir o iex:</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\">iex<span class=\"token operator\">></span> pid <span class=\"token operator\">=</span> self<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># pega o pid atual do processo</span>\n<span class=\"token comment\">#PID&lt;0.105.0></span>\niex<span class=\"token operator\">></span> send pid<span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mensagem com padrão 1\"</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> send pid<span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mensagem com padrão 2\"</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> Process<span class=\"token punctuation\">.</span>info pid<span class=\"token punctuation\">,</span> <span class=\"token atom symbol\">:messages</span> <span class=\"token comment\"># mostra as mensagens salvas na mailbox</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:messages</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token attr-name\">ok:</span> <span class=\"token string\">\"mensagem com padrão 1\"</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">ok:</span> <span class=\"token string\">\"mensagem com padrão 2\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> receive <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span> IO<span class=\"token punctuation\">.</span>puts msg <span class=\"token keyword\">end</span> <span class=\"token comment\"># macro que lida com as mensagens</span>\nmensagem com padrão <span class=\"token number\">1</span>\n<span class=\"token atom symbol\">:ok</span>\niex<span class=\"token operator\">></span> Process<span class=\"token punctuation\">.</span>info pid<span class=\"token punctuation\">,</span> <span class=\"token atom symbol\">:messages</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:messages</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token attr-name\">ok:</span> <span class=\"token string\">\"mensagem com padrão 2\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>No exemplo acima, usamos a função <code class=\"language-text\">self/0</code> para pegar o PID do processo atual, e usando a função <code class=\"language-text\">send/2</code> enviamos duas mensagens para nosso processo principal. Veja o primeiro parâmetro de send é o PID do processo, e seu segundo parâmetro é a mensagem. Essa mensagem pode ser em qualquer formato ou estrutura de dados, no caso do exemplo, usamos <strong>tuplas</strong>. Para recuperar as mensagens salvas na mailbox do processo usamos a macro <code class=\"language-text\">receive</code>. Sua funcionalidade é bastante simples, nela escrevemos pattern matching que vai lidar com a <strong>queue</strong> de mensagens da mailbox. Se um receive der match em <strong>uma</strong> mensagem, ele vai executar as regras computacionais ligadas a essa mensagem como mostrado no exemplo acima, que ao dar <strong>match</strong> na mensagem chamamos a função <code class=\"language-text\">IO.puts/1</code> retornando a mensagem para o processo. Se <code class=\"language-text\">receive</code> não der match com qualquer mensagem na mailbox, ela vai bloquear o processo, esperando por uma mensagem que possa dar match. Para evitar esse bloqueio podemos definir um timeout que expressa o tempo limite de bloqueio a espera de um match. Veja abaixo um exemplo usando <code class=\"language-text\">after</code> para definir nosso timeout.</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\">iex<span class=\"token operator\">></span> receive <span class=\"token keyword\">do</span>\n<span class=\"token operator\">...</span>>  msm <span class=\"token operator\">-></span> msm\n<span class=\"token operator\">...</span>> <span class=\"token keyword\">after</span>\n<span class=\"token operator\">...</span>>  <span class=\"token number\">1000</span> <span class=\"token operator\">-></span> <span class=\"token string\">\"nada aconteceu depois de 1s\"</span>\n<span class=\"token operator\">...</span>> <span class=\"token keyword\">end</span>\n<span class=\"token string\">\"nada aconteceu depois de 1s\"</span></code></pre></div>\n<p>Podemos criar outros processos Erlang usando a função <code class=\"language-text\">spawn/1</code> ou <code class=\"language-text\">spawn/3</code>. Vamos a um exemplo usando <code class=\"language-text\">spawn/1</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\">iex<span class=\"token operator\">></span> pid <span class=\"token operator\">=</span> spawn <span class=\"token keyword\">fn</span> <span class=\"token operator\">-></span> <span class=\"token number\">5</span> <span class=\"token operator\">+</span> <span class=\"token number\">5</span> <span class=\"token keyword\">end</span>\niex<span class=\"token operator\">></span> Process<span class=\"token punctuation\">.</span>alive? pid\n<span class=\"token boolean\">false</span></code></pre></div>\n<p>No exemplo acima, criamos um processo com <code class=\"language-text\">spawn/1</code>, essa função nos devolve o PID deste processo criado. A função de soma (5 + 5) é executada nesse processo isolado, e quando finalizada, o processo que criamos deixa de existir. Podemos verificar se um processo existe pelo método <code class=\"language-text\">Process.alive?/1</code>.</p>\n<p>Mas você deve estar se perguntando: Quando usar processos? A resposta dessa pergunta não é muito diferente em comparação com outras linguagens que buscam concorrência em suas operações. Buscamos concorrência para <strong>lidar</strong> com coisas ao mesmo tempo, como acessar uma api externa ou ler algo no disco, algo que lida com I/O bound, e no espaço de espera entre as operações I/O podemos seguir executando outros códigos, pois não necessitamos da dependência sequencial dos dados. E em Elixir podemos usar os processos para lidar e salvar estado mutável ou para código concorrente.</p>\n<h3>Lidando com estado usando processos</h3>\n<p>Elixir é uma <strong>linguagem funcional</strong>, sendo funcional ela também é imutável. Os dados são <strong>imutáveis</strong>. Porém podemos manter estado usando processos. Mantemos estado em um processo elixir usando recursão. Vamos criar um modelo de <strong>stack</strong>(pilha) usando processos na prática. Primeiro vamos criar um novo projeto: <code class=\"language-text\">mix new process_in_elixir</code></p>\n<p>Crie um arquivo na pasta lib chamado stack_normal.ex.</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\"><span class=\"token keyword\">defmodule</span> ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal <span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">def</span> start_link<span class=\"token punctuation\">(</span>initialStack <span class=\"token operator\">\\\\</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    pid <span class=\"token operator\">=</span> spawn_link __MODULE__<span class=\"token punctuation\">,</span> <span class=\"token atom symbol\">:loop</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>initialStack<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> pid<span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">def</span> child_spec<span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token punctuation\">%</span><span class=\"token punctuation\">{</span>\n      <span class=\"token attr-name\">id:</span> __MODULE__<span class=\"token punctuation\">,</span>\n      <span class=\"token attr-name\">start:</span> <span class=\"token punctuation\">{</span>__MODULE__<span class=\"token punctuation\">,</span> <span class=\"token atom symbol\">:start_link</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>opts<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token attr-name\">type:</span> <span class=\"token atom symbol\">:worker</span><span class=\"token punctuation\">,</span>\n      <span class=\"token attr-name\">restart:</span> <span class=\"token atom symbol\">:permanent</span><span class=\"token punctuation\">,</span>\n      <span class=\"token attr-name\">shutdown:</span> <span class=\"token number\">500</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">def</span> loop<span class=\"token punctuation\">(</span>stack <span class=\"token operator\">\\\\</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    receive <span class=\"token keyword\">do</span>\n      <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:push</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span>\n        newStack <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>value <span class=\"token operator\">|</span> stack<span class=\"token punctuation\">]</span>\n        loop newStack\n      <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:pop</span><span class=\"token punctuation\">,</span> sender<span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span>\n        <span class=\"token punctuation\">[</span>head <span class=\"token operator\">|</span> tail<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> stack\n        send sender<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> head<span class=\"token punctuation\">}</span>\n        loop tail\n      <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:show</span><span class=\"token punctuation\">,</span> sender<span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span>\n        send sender<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> Enum<span class=\"token punctuation\">.</span>reverse stack<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:raise</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span>\n        raise <span class=\"token string\">\"error no processo\"</span>\n    <span class=\"token keyword\">end</span>\n    loop stack\n  <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">def</span> push<span class=\"token punctuation\">(</span>pid<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">do:</span> send pid<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:push</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">def</span> raiseProcess<span class=\"token punctuation\">(</span>pid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">do:</span> send pid<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:raise</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">def</span> pop<span class=\"token punctuation\">(</span>pid<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    send pid<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:pop</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n    receive <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> itemDeleted<span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span> itemDeleted <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">def</span> show<span class=\"token punctuation\">(</span>pid<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    send pid<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:show</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n    receive <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> stack<span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span> stack <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>Podemos rodar nosso código pelo iex: <code class=\"language-text\">iex -S mix</code></p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\">iex<span class=\"token operator\">></span> <span class=\"token keyword\">alias</span> ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal\nProcessInElixir<span class=\"token punctuation\">.</span>StackNormal\niex<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> pid<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> StackNormal<span class=\"token punctuation\">.</span>start_link\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#PID&lt;0.326.0>}</span>\niex<span class=\"token operator\">></span> StackNormal<span class=\"token punctuation\">.</span>push pid<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Japão\"</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:push</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Japão\"</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> StackNormal<span class=\"token punctuation\">.</span>push pid<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Alemanha\"</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:push</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Alemanha\"</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> StackNormal<span class=\"token punctuation\">.</span>push pid<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Brasil\"</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:push</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Brasil\"</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> StackNormal<span class=\"token punctuation\">.</span>pop pid\n<span class=\"token string\">\"Brasil\"</span>\niex<span class=\"token operator\">></span> StackNormal<span class=\"token punctuation\">.</span>show pid\n<span class=\"token punctuation\">[</span><span class=\"token string\">\"Japão\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Alemanha\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Podemos notar que usamos a função <code class=\"language-text\">spawn_link/3</code>, sendo o primeiro argumento o módulo do processo; segundo argumento a função recursiva que vai manter o estado e o terceiro argumento uma lista com os valores iniciais da stack. Usando agora nossa função <code class=\"language-text\">StackNormal</code> podemos fazer vários push em nossa <strong>stack</strong>. O interessante é que não estamos mudamos os valores nas variáveis, e sim estamos criando uma nova lista a cada interação com o <strong>loop</strong> do processo. Conseguimos recuperar o valor da nossa <strong>stack</strong> para o processo pai pois enviamos uma mensagem para o PID do process Stack com o PID do processo pai, o receive da Stack da match com esta mensagem, e envia a stack em forma de List para o processo pai, o processo pai por sua vez usa o receive para tratar a mensagem.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 810px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMFAgT/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAaTH5Z4ygGn/xAAaEAABBQEAAAAAAAAAAAAAAAASAAECAxMQ/9oACAEBAAEFAq9FIhq3F+//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREC/9oACAEDAQE/AUoPVP/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/AVn/xAAbEAABBAMAAAAAAAAAAAAAAAARAAESICEiof/aAAgBAQAGPwJ5lPEkYK27T//EABwQAAIBBQEAAAAAAAAAAAAAAAERACAhMUFRcf/aAAgBAQABPyEwF8NdgNnpEzOc37o//9oADAMBAAIAAwAAABDMD//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8QybYUNxH/xAAWEQEBAQAAAAAAAAAAAAAAAAARARD/2gAIAQIBAT8QWpn/xAAdEAACAgIDAQAAAAAAAAAAAAABEQAhMUFRYaHh/9oACAEBAAE/EDGLgRAs7XUzz5AB4zL+xXBX2aTRgwJ//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Troca de mensagens entre processos\"\n        title=\"Troca de mensagens entre processos\"\n        src=\"/static/c60f341fde7e219cafd3b4e02578de20/627f4/troca-de-mensagens-entre-processos.jpg\"\n        srcset=\"/static/c60f341fde7e219cafd3b4e02578de20/efcb5/troca-de-mensagens-entre-processos.jpg 203w,\n/static/c60f341fde7e219cafd3b4e02578de20/02e66/troca-de-mensagens-entre-processos.jpg 405w,\n/static/c60f341fde7e219cafd3b4e02578de20/627f4/troca-de-mensagens-entre-processos.jpg 810w,\n/static/c60f341fde7e219cafd3b4e02578de20/78959/troca-de-mensagens-entre-processos.jpg 1215w,\n/static/c60f341fde7e219cafd3b4e02578de20/d165a/troca-de-mensagens-entre-processos.jpg 1400w\"\n        sizes=\"(max-width: 810px) 100vw, 810px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Podemos notar que usamos <code class=\"language-text\">spawn_link/3</code> para linkar dois processos. Neste caso linkamos o processo StackNormal com o processo principal da aplicação. Isso significa, que se o StackNormal der crash, o erro vai comprometer também o processo que está ligado a ele. E agora que entramos em uma das partes mais importante do Elixir, seu modelo de tolerância a falhas.</p>\n<h3>Tolerância a falhas</h3>\n<p>Em <strong>Erlang</strong> introduz a filosofia “let it crash”. A ideia é que você não precisa se preocupar tanto em programar defensivamente, tentando antecipar todo tipo de problema que pode ocorrer. Então podemos fazer esse código crítico ser supervisionado por outro processo que tem somente a responsabilidade de lidar com os processos que falham. Os <strong>Supervisor</strong>, são processos que monitoram outros processos, e caso um ou alguns processos possam dar erro, ele implementa estratégias para reiniciar automaticamente esses processos, tentando assim colocá-los novamente em um estado consistente.</p>\n<p>Vamos ao código, vamos criar nosso <strong>Supervisor</strong>. Crie o arquivo stack_supervisor.ex.</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\"><span class=\"token keyword\">defmodule</span> StackSupervisor <span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">use</span> Supervisor\n  <span class=\"token keyword\">def</span> start_link<span class=\"token punctuation\">(</span>_arg <span class=\"token operator\">\\\\</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    Supervisor<span class=\"token punctuation\">.</span>start_link __MODULE__<span class=\"token punctuation\">,</span> <span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">name:</span> __MODULE__\n  <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">def</span> init<span class=\"token punctuation\">(</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">]</span>\n    Supervisor<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">(</span>children<span class=\"token punctuation\">,</span> <span class=\"token attr-name\">strategy:</span> <span class=\"token atom symbol\">:one_for_one</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">def</span> which_children<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">do:</span> Supervisor<span class=\"token punctuation\">.</span>which_children __MODULE__\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>Vamos rodar nosso código no iex:</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\">iex<span class=\"token operator\">></span> StackSupervisor<span class=\"token punctuation\">.</span>start_link\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">#PID&lt;0.230.0>}</span>\niex<span class=\"token operator\">></span> StackSupervisor<span class=\"token punctuation\">.</span>which_children\n<span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">,</span> <span class=\"token comment\">#PID&lt;0.231.0>, :worker,</span>\n   <span class=\"token punctuation\">[</span>ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\niex<span class=\"token operator\">></span> ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">.</span>push pid<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">231</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Japão\"</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:push</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Japão\"</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">.</span>show pid<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">231</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">\"Japão\"</span><span class=\"token punctuation\">]</span>\niex<span class=\"token operator\">></span> ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">.</span>raiseProcess pid<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">231</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:raise</span><span class=\"token punctuation\">}</span>\niex<span class=\"token operator\">></span> StackSupervisor<span class=\"token punctuation\">.</span>which_children\n<span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">,</span> <span class=\"token comment\">#PID&lt;0.237.0>, :worker,</span>\n   <span class=\"token punctuation\">[</span>ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\niex<span class=\"token operator\">></span> ProcessInElixir<span class=\"token punctuation\">.</span>StackNormal<span class=\"token punctuation\">.</span>show pid<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">237</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Como demos ver acima, iniciamos um <strong>Supervisor</strong>, criamos um children usando nosso processo <strong>StackNormal</strong>. Usando o método <code class=\"language-text\">which_children</code> podemos ver os processos linkados a nosso Supervisor, com ele vemos um PID já iniciado da <strong>StackNormal</strong>. Damos um push e show para averiguar se os dados estão sendo salvos. Agora, vamos usar a função <code class=\"language-text\">raiseProcess/0</code> da StackNormal para produzir um erro no processo. Quando este erro acontece, o <strong>Supervisor</strong>, simplesmente reinicia outro processo no lugar do que foi corrompido. Podemos notar isso chamando novamente <code class=\"language-text\">which_children</code>, o processo foi reiniciado, podemos notar que seu PID foi alterado também. Se chamarmos show para esse novo PID, veremos que o estado está limpo, no caso é retornando um List vazio.</p>\n<p>Podemos usar várias estratégias, como adicionar um supervisor em outro supervisor, ou mesmo adicionar por demanda processos usando <strong><a href=\"https://hexdocs.pm/elixir/DynamicSupervisor.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DynamicSupervisor</a></strong>. Toda essa arquitetura de ter supervisores supervisionando outros processos ou mesmo supervisores é conhecido como <strong>Árvore de supervisão</strong>(supervision tree).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 810px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.00985221674877%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAdgkIXlo/8QAGhAAAwADAQAAAAAAAAAAAAAAAAECAxITMf/aAAgBAQABBQLdMjRHRGW3I8lIXn//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAwEBPwGH/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bp//EABsQAAICAwEAAAAAAAAAAAAAAAABESECEDGR/9oACAEBAAY/AoslLI4/Ct//xAAaEAEBAQEAAwAAAAAAAAAAAAABEQAhEEFR/9oACAEBAAE/IWyJnzJURnsfGoJHdEk6ZUO//9oADAMBAAIAAwAAABD03//EABcRAQEBAQAAAAAAAAAAAAAAAAEAITH/2gAIAQMBAT8QE8sv/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAgEBPxCVUzT/xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMVHR8f/aAAgBAQABPxCzLiEvzsG0NkYs7PsIlgA3ZHGMW8PsRDaDP//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Árvore de supervisão\"\n        title=\"Árvore de supervisão\"\n        src=\"/static/63e3a568e927a2f67878193d1581e6ee/627f4/arvore-de-supervisao.jpg\"\n        srcset=\"/static/63e3a568e927a2f67878193d1581e6ee/efcb5/arvore-de-supervisao.jpg 203w,\n/static/63e3a568e927a2f67878193d1581e6ee/02e66/arvore-de-supervisao.jpg 405w,\n/static/63e3a568e927a2f67878193d1581e6ee/627f4/arvore-de-supervisao.jpg 810w,\n/static/63e3a568e927a2f67878193d1581e6ee/78959/arvore-de-supervisao.jpg 1215w,\n/static/63e3a568e927a2f67878193d1581e6ee/c293a/arvore-de-supervisao.jpg 1232w\"\n        sizes=\"(max-width: 810px) 100vw, 810px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<hr>\n<h3>Abstrações: Agent, Task e GenServer</h3>\n<p>Em nossos exemplos para a criação de processos e a comunicação com eles, usamos funções como: <code class=\"language-text\">spawn/1</code>, <code class=\"language-text\">send/2</code> e <code class=\"language-text\">receive</code>. Porém o Elixir provê abstrações que facilitam a criação dos processos.</p>\n<p>Podemos usar <strong>Agent</strong> quando queremos apenas lidar com estado. Para tarefas que rodem em paralelo ou concorrentemente com outras tarefas podemos usar <strong>Task</strong>. Ou podemos usar o <strong>GenServer</strong> para lidar com estado e para lidar com tarefas complexas como tarefas concorrentes.</p>\n<p>Criei um repositório, com vários exemplos usando Agent, Task e GenServer:</p>\n<ul>\n<li><strong><a href=\"https://github.com/alexandreservian/process-in-elixir\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">process-in-elixir</a></strong></li>\n</ul>\n<hr>\n<h3>Como isso tudo funciona no Elixir</h3>\n<p>Bem quando inciamos a máquina virtual do Erlang, a <strong>BEAM</strong>, ela cria uma <strong>thread</strong> por core. E em cada <strong>thread</strong> ela cria um <strong>scheduler</strong>. E cada <strong>scheduler</strong> vai lidar com sua própria <strong>run queue</strong> contendo processos. O <strong>scheduler</strong> retira um processos da sua <strong>run queue</strong> e aloca um “pedaço de tempo”. Se o processo exceder seu “pedaço de tempo” o <strong>scheduler</strong> pode pausar esse processo, e colocá-lo de volta na <strong>run queue</strong> e passar para o <strong>próximo</strong> processo da fila.</p>\n<p>A <strong>BEAM</strong> também é responsável por encaminhar os processos para as run queues dos <strong>schedulers</strong> disponíveis. Esse gerenciamento é feito pelo <strong>Load Balancer</strong> da BEAM. O <strong>Load Balancer</strong> ajuda a remover processos em schedulers sobrecarregados e entregá-los a <strong>schedulers</strong> vazios. O <strong>load balancer</strong> vista manter o número máximo de processos executáveis iguais entre os <strong>schedulers</strong>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 810px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.08374384236453%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAACA//EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAFiSMl1t1P/xAAZEAACAwEAAAAAAAAAAAAAAAAAAQIRMyH/2gAIAQEAAQUCg+PYg3T2P//EABURAQEAAAAAAAAAAAAAAAAAAAIQ/9oACAEDAQE/AVP/xAAWEQADAAAAAAAAAAAAAAAAAAACEDL/2gAIAQIBAT8BOl//xAAaEAACAgMAAAAAAAAAAAAAAAAAARAiMTIz/9oACAEBAAY/An0dhGR2e4o//8QAHBABAAIBBQAAAAAAAAAAAAAAAQARkSExQVGB/9oACAEBAAE/ITM54lvCC9sXE36LN4MUAJ//2gAMAwEAAgADAAAAEPTP/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/EBhP/8QAFhEAAwAAAAAAAAAAAAAAAAAAARCx/9oACAECAQE/ELBf/8QAHhABAAICAQUAAAAAAAAAAAAAAQARITFBUZGx0fD/2gAIAQEAAT8QsdsoJyvUYBbaZNaZUepx5JdbQF4kJ+mmC0Hef//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Funcionamento da BEAM\"\n        title=\"Funcionamento da BEAM\"\n        src=\"/static/9c174912265f726bf806d1e8263f6383/627f4/funcionamento-da-beam.jpg\"\n        srcset=\"/static/9c174912265f726bf806d1e8263f6383/efcb5/funcionamento-da-beam.jpg 203w,\n/static/9c174912265f726bf806d1e8263f6383/02e66/funcionamento-da-beam.jpg 405w,\n/static/9c174912265f726bf806d1e8263f6383/627f4/funcionamento-da-beam.jpg 810w,\n/static/9c174912265f726bf806d1e8263f6383/78959/funcionamento-da-beam.jpg 1215w,\n/static/9c174912265f726bf806d1e8263f6383/d4e6b/funcionamento-da-beam.jpg 1278w\"\n        sizes=\"(max-width: 810px) 100vw, 810px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3>Conclusão</h3>\n<p>Bem, quanto mais estudo e uso Elixir, mais fico empolgado. A forma que ele lida com concorrência é muito interessante. Programação funcional aliada à uma linguagem muito completa e moderna é uma união que agrega e muito nosso ferramental para criar softwares no dia a dia. Vlws.</p>","timeToRead":9,"frontmatter":{"date":"24/03/2020","path":"/elixir-concorrencia-processos-e-tolerancia-a-falhas","title":"Elixir: Concorrência, Processos e Tolerância a falhas","subTitle":"Vamos conversar sobre o modelo de atores para concorrência e como o Erlang/Elixir lida com tolerância a falhas.","banner":{"author":"Daria Nepriakhina","href":"https://unsplash.com/photos/guiQYiRxkZY","image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAUaGiXMeP//EABgQAQEBAQEAAAAAAAAAAAAAAAEAEQIh/9oACAEBAAEFAvCyeS5DMAW//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAQUBAAAAAAAAAAAAAAAAAAEQITFBkf/aAAgBAQAGPwKVejemn//EABoQAAMBAAMAAAAAAAAAAAAAAAABETEhcZH/2gAIAQEAAT8hUMO2NCgRsLiID7vo/9oADAMBAAIAAwAAABBDz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EKf/xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMUFRYYH/2gAIAQEAAT8QQkCeiMC9JZnkdqfbgw5UdjEYHhRFwMdn/9k=","aspectRatio":1.5957446808510638,"src":"/static/139cbf4485d3b11db05387901b5ef177/21095/banner.jpg","srcSet":"/static/139cbf4485d3b11db05387901b5ef177/36b10/banner.jpg 300w,\n/static/139cbf4485d3b11db05387901b5ef177/88367/banner.jpg 600w,\n/static/139cbf4485d3b11db05387901b5ef177/21095/banner.jpg 1200w,\n/static/139cbf4485d3b11db05387901b5ef177/97ce3/banner.jpg 1800w,\n/static/139cbf4485d3b11db05387901b5ef177/d23b7/banner.jpg 1920w","sizes":"(max-width: 1200px) 100vw, 1200px"},"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMEAf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHUzWjrhZWIziv/xAAZEAACAwEAAAAAAAAAAAAAAAAAAQIREhP/2gAIAQEAAQUCGZOjOiZuJZZOdS//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAaEAABBQEAAAAAAAAAAAAAAAAAARAgMUFR/9oACAEBAAY/AnpDkMP/xAAcEAEBAAICAwAAAAAAAAAAAAABABEhQWFxgZH/2gAIAQEAAT8hBh3O3NlNB5g5p9LulmDUbSYA+L//2gAMAwEAAgADAAAAEEwHgP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABwQAQADAAMBAQAAAAAAAAAAAAEAESExUWGR4f/aAAgBAQABPxDUa85bstxV7WuS1KL22bgXSVfhEkILYvo82UL76/IpUhSxOYihCrriNmgDmP/Z","width":1200,"height":1200,"src":"/static/139cbf4485d3b11db05387901b5ef177/ebdd7/banner.jpg","srcSet":"/static/139cbf4485d3b11db05387901b5ef177/ebdd7/banner.jpg 1x,\n/static/139cbf4485d3b11db05387901b5ef177/b9876/banner.jpg 1.5x"}}}}}}},"pageContext":{}}}